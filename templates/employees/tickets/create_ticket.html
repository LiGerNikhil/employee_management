{% extends layout_path %}

{% load static %}

{% block title %}Create Support Ticket | Employee Portal{% endblock %}

{% block content %}
  <style>
    :root {
      --app-radius: 18px;
      --app-soft-bg: #f4f6fb;
      --app-card-bg: #ffffff;
      --app-border: rgba(17, 24, 39, 0.06);
      --app-muted: #6b7280;
      --app-shadow: 0 18px 42px rgba(15, 23, 42, 0.12);
    }

    body {
      background: var(--app-soft-bg);
    }

    .app-screen {
      display: flex;
      flex-direction: column;
      gap: 1.5rem;
      padding-bottom: 2.6rem;
    }

    .app-screen--padded {
      padding: 1.6rem 0 2.6rem;
    }

    .app-card {
      background: var(--app-card-bg);
      border-radius: var(--app-radius);
      border: 1px solid var(--app-border);
      box-shadow: var(--app-shadow);
      padding: 1.55rem 1.65rem;
    }

    .app-hero {
      position: relative;
      overflow: hidden;
      color: #f8fafc;
      background: linear-gradient(135deg, #6366f1 0%, #7c3aed 100%);
      display: grid;
      gap: 1.1rem;
    }

    .app-hero::after {
      content: '';
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top right, rgba(255, 255, 255, 0.25), transparent 55%);
      pointer-events: none;
    }

    .app-hero__head {
      position: relative;
      display: flex;
      flex-direction: column;
      gap: 0.6rem;
    }

    .app-hero__title {
      font-size: 1.65rem;
      margin: 0;
    }

    .app-hero__subtitle {
      font-size: 0.92rem;
      margin: 0;
      max-width: 520px;
      opacity: 0.9;
    }

    .app-hero__actions {
      position: relative;
      display: flex;
      flex-wrap: wrap;
      gap: 0.6rem;
    }

    .app-chip {
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
      padding: 0.4rem 0.95rem;
      border-radius: 99px;
      font-size: 0.72rem;
      letter-spacing: 0.05em;
      text-transform: uppercase;
      background: rgba(15, 23, 42, 0.18);
      color: rgba(248, 250, 252, 0.9);
    }

    .app-chip--muted {
      background: rgba(99, 102, 241, 0.12);
      color: #4338ca;
    }

    .app-form {
      display: grid;
      gap: 1.25rem;
    }

    .app-field {
      display: grid;
      gap: 0.55rem;
    }

    .app-field__label {
      font-size: 0.78rem;
      letter-spacing: 0.08em;
      text-transform: uppercase;
      color: var(--app-muted);
      font-weight: 600;
      display: inline-flex;
      align-items: center;
      gap: 0.4rem;
    }

    .app-field__label i {
      font-size: 1rem;
      color: #6366f1;
    }

    .app-field__label .app-required {
      color: #ef4444;
      text-transform: none;
      letter-spacing: 0;
    }

    .app-field__input {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      background: #f8f9ff;
      border-radius: 16px;
      border: 1px solid rgba(99, 102, 241, 0.15);
      padding: 0.75rem 0.9rem;
      transition: border-color 0.2s ease, box-shadow 0.2s ease;
    }

    .app-field__input:focus-within {
      border-color: #6366f1;
      box-shadow: 0 12px 28px rgba(99, 102, 241, 0.18);
      background: #fff;
    }

    .app-field__icon {
      width: 42px;
      height: 42px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      font-size: 1.15rem;
      background: rgba(99, 102, 241, 0.1);
      color: #4338ca;
    }

    .app-control {
      border: none;
      background: transparent;
      width: 100%;
      padding: 0;
      font-size: 0.95rem;
      color: #111827;
      box-shadow: none !important;
    }

    .app-control:focus {
      outline: none;
    }

    select.app-control {
      cursor: pointer;
    }

    textarea.app-control {
      min-height: 150px;
      resize: vertical;
      padding-top: 0.1rem;
    }

    .app-field__input--textarea {
      align-items: flex-start;
    }

    .app-field__input--file {
      flex-wrap: wrap;
    }

    .app-control--file {
      padding: 0.35rem 0;
    }

    .app-control--file::file-selector-button {
      border: none;
      border-radius: 999px;
      background: rgba(99, 102, 241, 0.12);
      color: #4338ca;
      padding: 0.45rem 1rem;
      margin-right: 0.75rem;
      cursor: pointer;
    }

    .app-field__help {
      font-size: 0.75rem;
      color: var(--app-muted);
      margin: 0;
    }

    .app-info {
      display: flex;
      gap: 0.9rem;
      align-items: flex-start;
      background: linear-gradient(135deg, rgba(59, 130, 246, 0.12), rgba(59, 130, 246, 0.05));
      border-radius: 16px;
      padding: 1rem 1.1rem;
      border: 1px solid rgba(59, 130, 246, 0.12);
    }

    .app-info__icon {
      width: 44px;
      height: 44px;
      border-radius: 14px;
      display: grid;
      place-items: center;
      font-size: 1.3rem;
      color: #1d4ed8;
      background: rgba(59, 130, 246, 0.18);
    }

    .app-info h6 {
      margin: 0 0 0.25rem;
      font-size: 0.95rem;
      color: #1f2937;
    }

    .app-info p,
    .app-info small {
      margin: 0;
      font-size: 0.78rem;
      color: #1f2937;
    }

    .app-actions {
      display: flex;
      gap: 0.75rem;
      flex-wrap: wrap;
      justify-content: flex-end;
    }

    .app-actions__btn {
      border-radius: 999px;
      padding: 0.65rem 1.4rem;
      font-weight: 600;
      font-size: 0.88rem;
      display: inline-flex;
      align-items: center;
      gap: 0.45rem;
    }

    .app-actions__btn--primary {
      box-shadow: 0 12px 28px rgba(99, 102, 241, 0.25);
    }

    .app-tips {
      display: grid;
      gap: 1rem;
      background: linear-gradient(145deg, #ffffff 0%, #f5f3ff 100%);
      border: 1px solid rgba(99, 102, 241, 0.12);
    }

    .app-tips__title {
      font-size: 1rem;
      margin: 0;
      color: #312e81;
    }

    .app-tips__list {
      list-style: none;
      padding: 0;
      margin: 0;
      display: grid;
      gap: 0.65rem;
    }

    .app-tips__list li {
      display: flex;
      align-items: flex-start;
      gap: 0.5rem;
      font-size: 0.8rem;
      color: #4338ca;
    }

    .app-tips__list li i {
      font-size: 1rem;
      margin-top: 0.05rem;
    }

    .app-tips__list li span {
      color: var(--app-muted);
    }

    @media (max-width: 992px) {
      .app-card {
        padding: 1.45rem 1.35rem;
      }
    }

    @media (max-width: 768px) {
      .app-screen--padded {
        padding: 1.2rem 0 2.2rem;
      }

      .app-card {
        padding: 1.35rem 1.2rem;
      }

      .app-hero__title {
        font-size: 1.45rem;
      }

      .app-hero__actions .btn {
        flex: 1;
        justify-content: center;
      }

      .app-actions {
        justify-content: center;
      }

      .app-actions__btn {
        flex: 1 1 100%;
        justify-content: center;
      }
    }

    @media (max-width: 576px) {
      .app-card {
        padding: 1.2rem 1.05rem;
      }

      .app-field__input {
        padding: 0.7rem 0.8rem;
      }

      .app-field__icon {
        width: 38px;
        height: 38px;
        font-size: 1.05rem;
      }

      .app-info {
        flex-direction: column;
      }

      .app-info__icon {
        width: 40px;
        height: 40px;
      }
    }
  </style>

  <div class="row justify-content-center">
    <div class="col-xl-7 col-lg-9 col-12">
      <div class="app-screen app-screen--padded">

        <!-- Hero -->
        <section class="app-card app-hero">
          <div class="app-hero__head">
            <span class="app-chip"><i class="bx bx-support"></i> Support request</span>
            <h1 class="app-hero__title">Create a support ticket</h1>
            <p class="app-hero__subtitle">Let us know what went wrong and our team will reach out with a solution tailored for you.</p>
          </div>
          <div class="app-hero__actions">
            <a href="{% url 'employees:employee_tickets' %}" class="btn btn-outline-light btn-sm">
              <i class="bx bx-arrow-back"></i> My tickets
            </a>
          </div>
        </section>

        <!-- Ticket Form -->
        <section class="app-card">
          <form method="post" enctype="multipart/form-data" class="app-form">
            {% csrf_token %}

            <div class="app-field">
              <label for="subject" class="app-field__label">
                <i class="bx bx-edit-alt"></i>
                <span>Subject</span>
                <span class="app-required">*</span>
              </label>
              <div class="app-field__input">
                <span class="app-field__icon" style="background: rgba(99, 102, 241, 0.14); color: #4338ca;">
                  <i class="bx bx-edit-alt"></i>
                </span>
                <input type="text"
                       class="app-control"
                       id="subject"
                       name="subject"
                       placeholder="Brief title for your issue"
                       required>
              </div>
              <p class="app-field__help">Write a clear summary so we can route your request quickly.</p>
            </div>

            <div class="app-field">
              <label for="category" class="app-field__label">
                <i class="bx bx-category"></i>
                <span>Category</span>
                <span class="app-required">*</span>
              </label>
              <div class="app-field__input">
                <span class="app-field__icon" style="background: rgba(20, 184, 166, 0.16); color: #0f766e;">
                  <i class="bx bx-category"></i>
                </span>
                <select class="app-control" id="category" name="category" required>
                  <option value="">Select a category</option>
                  {% for category_code, category_label in category_choices %}
                    <option value="{{ category_code }}">{{ category_label }}</option>
                  {% endfor %}
                </select>
              </div>
              <p class="app-field__help">Pick the option that best matches your issue.</p>
            </div>

            <div class="app-field">
              <label for="priority" class="app-field__label">
                <i class="bx bx-slider-alt"></i>
                <span>Priority</span>
              </label>
              <div class="app-field__input">
                <span class="app-field__icon" style="background: rgba(251, 191, 36, 0.18); color: #b45309;">
                  <i class="bx bx-slider-alt"></i>
                </span>
                <select class="app-control" id="priority" name="priority">
                  {% for priority_code, priority_label in priority_choices %}
                    <option value="{{ priority_code }}" {% if priority_code == "medium" %}selected{% endif %}>{{ priority_label }}</option>
                  {% endfor %}
                </select>
              </div>
              <p class="app-field__help">Let us know how urgent this feels from your side.</p>
            </div>

            <div class="app-field">
              <label for="description" class="app-field__label">
                <i class="bx bx-detail"></i>
                <span>Description</span>
                <span class="app-required">*</span>
              </label>
              <div class="app-field__input app-field__input--textarea">
                <span class="app-field__icon" style="background: rgba(59, 130, 246, 0.18); color: #1d4ed8;">
                  <i class="bx bx-detail"></i>
                </span>
                <textarea class="app-control"
                          id="description"
                          name="description"
                          rows="8"
                          placeholder="Reason for the ticket or anything we should know"
                          required></textarea>
              </div>
              <p class="app-field__help">More detail means faster fixes. Screenshots and timelines help a lot.</p>
            </div>

            <div class="app-field">
              <label for="attachment" class="app-field__label">
                <i class="bx bx-paperclip"></i>
                <span>Attachment</span>
              </label>
              <div class="app-field__input app-field__input--file">
                <span class="app-field__icon" style="background: rgba(99, 102, 241, 0.14); color: #4338ca;">
                  <i class="bx bx-cloud-upload"></i>
                </span>
                <input type="file"
                       class="app-control app-control--file"
                       id="attachment"
                       name="attachment">
              </div>
              <p class="app-field__help">Optional: upload screenshots, documents, or logs (max 10MB).</p>
            </div>

            <div class="app-info">
              <span class="app-info__icon"><i class="bx bx-time-five"></i></span>
              <div>
                <h6>What happens next?</h6>
                <p>Our support team reviews new tickets throughout the day. Expect a response in your inbox and inside the app once we pick it up.</p>
              </div>
            </div>

            <div class="app-actions">
              <a href="{% url 'employees:employee_tickets' %}" class="btn btn-outline-secondary app-actions__btn">
                <i class="bx bx-chevron-left"></i> Cancel
              </a>
              <button type="submit" class="btn btn-primary app-actions__btn app-actions__btn--primary">
                <i class="bx bx-send"></i> Submit ticket
              </button>
            </div>
          </form>
        </section>

        <!-- Tips -->
        <section class="app-card app-tips">
          <div>
            <span class="app-chip app-chip--muted"><i class="bx bx-bulb"></i> Pro tips</span>
            <h6 class="app-tips__title">Write tickets that get resolved faster</h6>
          </div>
          <ul class="app-tips__list">
            <li><i class="bx bx-target-lock"></i><span>Be precise in your subject so we instantly know the topic.</span></li>
            <li><i class="bx bx-list-check"></i><span>Share the steps that lead to the issue and what you already tried.</span></li>
            <li><i class="bx bx-image-alt"></i><span>Attach screenshots or files when visuals explain the problem better.</span></li>
            <li><i class="bx bx-time"></i><span>Mention when the issue started and how often it happens.</span></li>
          </ul>
        </section>

      </div>
    </div>
  </div>
{% endblock %}
